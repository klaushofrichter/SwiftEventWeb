import{g as Q,u as p,h as X,i as Z,s as tt,j as et,r as c,k as st,l as ot,m as at,c as i,a as t,b as O,t as e,p as j,F,q as M,e as P,w as nt,o as l,n as K}from"./index-Dra4vEXb.js";const it=Q("data",{state:()=>({sensors:[],devices:[],notifications:[],selectedNotification:null,accountInfo:null,loading:!1,error:null}),getters:{getAccountInfo:d=>d.accountInfo},actions:{async fetchAccountInfo(){const d=p();if(!d.accountId)throw new Error("No account ID available");this.loading=!0,this.error=null;try{const o=await et.getAccountInfo(d.accountId);this.accountInfo=o}catch(o){throw this.error=o.message||"Failed to fetch account information",o}finally{this.loading=!1}},async fetchSensors(){const d=p();this.loading=!0,this.error=null;try{const o=await tt.getSensors(d.accountId),r=Object.keys(o)[0];o[r]&&Array.isArray(o[r])?this.sensors=o[r]:this.sensors=[]}catch(o){throw this.error=o.message||"Failed to fetch sensors",o}finally{this.loading=!1}},async fetchNotifications(){const d=p();this.loading=!0,this.error=null;try{const o=await Z.getNotifications(d.accountId),r=Object.keys(o)[0];o[r]&&Array.isArray(o[r])?this.notifications=o[r]:this.notifications=[]}catch(o){throw this.error=o.message||"Failed to fetch notifications",o}finally{this.loading=!1}},async fetchNotificationDetails(d){const o=p();this.loading=!0,this.error=null;try{const r=await Z.getNotificationDetails(o.accountId,d);this.selectedNotification=r}catch(r){throw this.error=r.message||"Failed to fetch notification details",r}finally{this.loading=!1}},clearSelectedNotification(){this.selectedNotification=null},async fetchDevices(){const d=p();this.loading=!0,this.error=null;try{const o=await X.getDevices(d.accountId);this.devices=Array.isArray(o)?o:[]}catch(o){throw this.error=o.message||"Failed to fetch devices",o}finally{this.loading=!1}}}}),lt="1.3.24",R={version:lt,"last-commit":"Sun Apr 20 00:18:43 UTC 2025"},rt={class:"space-y-6"},ct={class:"bg-white shadow rounded-lg p-6"},dt={key:0,class:"flex justify-center"},ut={key:1,class:"text-red-500 text-center"},ft={key:2,class:"bg-gray-50 p-4 rounded-lg"},ht={class:"font-medium text-gray-900"},gt={class:"mt-2 space-y-1"},yt={class:"text-sm text-gray-500"},vt={class:"text-sm text-gray-500"},mt={class:"text-sm text-gray-500"},xt={class:"bg-white shadow rounded-lg p-6"},pt={key:0,class:"flex justify-center"},_t={key:1,class:"text-red-500 text-center"},bt={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},wt={class:"font-medium text-gray-900"},St={class:"text-sm text-gray-500"},kt={class:"text-sm text-gray-500"},Dt={class:"text-sm text-gray-700 mt-2"},It={class:"text-sm text-gray-700"},Nt={class:"text-sm text-gray-700"},Et={class:"bg-white shadow rounded-lg p-6"},At={class:"flex justify-between items-center mb-4"},Ct={class:"flex items-center space-x-4"},jt={key:0,class:"text-sm text-gray-500 text-right min-w-[150px]"},Ft=["disabled"],Mt={key:0,class:"inline-flex items-center"},Lt={key:1},Vt={key:0,class:"text-red-500 text-center"},Tt={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4"},Ut={class:"flex justify-between items-start"},Bt={class:"font-medium text-gray-900"},$t={class:"text-sm text-gray-500"},zt={class:"mt-4"},Zt={class:"flex items-baseline"},Ot={class:"text-2xl font-semibold text-gray-700"},Pt={class:"ml-1 text-gray-500"},Kt={class:"text-xs text-gray-500 mt-1"},Rt={class:"mt-3 pt-3 border-t border-gray-200"},qt={class:"flex justify-between text-sm"},Ht={class:"text-gray-700"},Jt={class:"flex justify-between text-sm mt-1"},Wt={class:"text-gray-700"},Yt={class:"bg-white shadow rounded-lg p-6"},Gt={key:0,class:"flex justify-center"},Qt={key:1,class:"text-red-500 text-center"},Xt={key:2,class:"space-y-3"},te=["onClick"],ee={class:"flex justify-between items-start"},se={class:"font-medium text-gray-900"},oe={class:"text-sm text-gray-500 mt-1"},ae={class:"text-xl font-bold text-gray-900 mb-4"},ne={class:"space-y-4"},ie={class:"text-gray-600"},le={class:"grid grid-cols-2 gap-4 mt-2"},re={class:"text-sm text-gray-600"},ce={class:"text-sm text-gray-600"},de={class:"text-sm text-gray-600"},ue={class:"text-sm text-gray-600"},fe={class:"text-sm text-gray-600"},he={class:"text-sm text-gray-600"},ge={class:"mt-8 text-center"},ye={class:"text-xs text-gray-400"},xe={__name:"Dashboard",setup(d){const o=R.version,r=R["last-commit"],u=it(),q=p(),D=c(!1),w=c(null),S=st(()=>u.accountInfo),I=c(!1),y=c(!1),N=c(!1),_=c(null),v=c(null),b=c(null),f=c(null),m=c(null),x=c("");let k=null;const L=c([]),V=c([]),E=c([]),H=a=>({1:"°C",2:"°C",4:"%",17:""})[a]||"",A=a=>a?new Date(a*1e3).toLocaleString():"Never",J=a=>typeof a=="number"&&!Number.isInteger(a)?a.toFixed(2):a===0||a===1?a===1?"Open":"Closed":a,W=async()=>{w.value=null,_.value=null,v.value=null,b.value=null,D.value=!0;try{await u.fetchAccountInfo()}catch(a){w.value=a.msg||"Failed to fetch account information"}finally{D.value=!1}I.value=!0;try{await u.fetchDevices(),L.value=u.devices}catch(a){a.msg==="Permission Denied"?_.value="Your account may not be authorized to access this data":_.value=a.msg||"Failed to fetch devices"}finally{I.value=!1}y.value=!0;try{await u.fetchSensors(),E.value=u.sensors,m.value=Date.now(),C()}catch(a){v.value=a.msg||"Failed to fetch sensors"}finally{y.value=!1}N.value=!0;try{await u.fetchNotifications(),V.value=u.notifications}catch(a){b.value=a.msg||"Failed to fetch notifications"}finally{N.value=!1}},Y=async a=>{try{await u.fetchNotificationDetails(a),f.value=u.selectedNotification}catch(s){b.value=s.msg||"Failed to fetch notification details"}},T=()=>{f.value=null,u.clearSelectedNotification()},C=()=>{if(!m.value){x.value="";return}const s=Date.now()-m.value,g=Math.floor(s/1e3);if(g<10)x.value="just now";else if(g<60){const h=Math.round(g/10)*10;x.value=`about ${h} seconds ago`}else if(g<3600){const h=Math.floor(g/60);x.value=`about ${h} minute${h>1?"s":""} ago`}else{const h=Math.floor(g/3600);x.value=`about ${h} hour${h>1?"s":""} ago`}},G=async()=>{v.value=null,y.value=!0,m.value=null;try{const a=await u.fetchSensors();E.value=u.sensors,m.value=Date.now(),C()}catch(a){v.value=a.msg||"Failed to fetch sensors"}finally{y.value=!1}};return ot(()=>{W(),k=setInterval(C,1e3)}),at(()=>{k&&(clearInterval(k),k=null)}),(a,s)=>{var g,h,U,B,$,z;return l(),i("div",rt,[t("div",ct,[s[2]||(s[2]=t("h2",{class:"text-2xl font-bold text-gray-900 mb-4"},"Account Information",-1)),D.value?(l(),i("div",dt,s[1]||(s[1]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},null,-1)]))):w.value?(l(),i("div",ut,e(w.value),1)):(l(),i("div",ft,[t("h3",ht,e((g=S.value)==null?void 0:g.accountName),1),t("div",gt,[t("p",yt,"Created: "+e(A((h=S.value)==null?void 0:h.creationTime)),1),t("p",vt,"Time Zone: "+e((B=(U=S.value)==null?void 0:U.timeZone)==null?void 0:B.timeZoneId)+" ("+e((z=($=S.value)==null?void 0:$.timeZone)==null?void 0:z.offsetDisplay)+")",1),t("p",mt,"Email: "+e(j(q).getUserEmail),1)])]))]),t("div",xt,[s[4]||(s[4]=t("h2",{class:"text-2xl font-bold text-gray-900 mb-4"},"Devices",-1)),I.value?(l(),i("div",pt,s[3]||(s[3]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},null,-1)]))):_.value?(l(),i("div",_t,e(_.value),1)):(l(),i("div",bt,[(l(!0),i(F,null,M(L.value,n=>(l(),i("div",{key:n.id,class:"bg-gray-50 p-4 rounded-lg"},[t("h3",wt,e(n.name),1),t("p",St,"Manufacturer: "+e(n.manufacturer),1),t("p",kt,"Model: "+e(n.model),1),t("p",Dt,"Last Seen: "+e(A(n.lastContactTime)),1),t("p",It,"Battery: "+e(n.batteryLevel)+"%",1),t("p",Nt,"Signal: "+e(n.signalStrength)+" dBm",1)]))),128))]))]),t("div",Et,[t("div",At,[s[6]||(s[6]=t("h2",{class:"text-2xl font-bold text-gray-900"},"Metrics",-1)),t("div",Ct,[m.value?(l(),i("span",jt," Last update: "+e(x.value),1)):O("",!0),t("button",{onClick:G,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50",disabled:y.value},[y.value?(l(),i("span",Mt,s[5]||(s[5]=[t("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),P(" Updating ")]))):(l(),i("span",Lt,"Update"))],8,Ft)])]),v.value?(l(),i("div",Vt,e(v.value),1)):(l(),i("div",Tt,[(l(!0),i(F,null,M(E.value,n=>(l(),i("div",{key:n[0],class:"bg-gray-50 p-4 rounded-lg border border-gray-200 hover:shadow-md transition-shadow duration-200"},[t("div",Ut,[t("div",null,[t("h3",Bt,e(n[1]),1),t("p",$t,e(n[2]),1)]),t("span",{class:K(["px-2 py-1 text-xs rounded-full",n[9]?"bg-red-100 text-red-800":"bg-green-100 text-green-800"])},e(n[9]?"Alert":"Normal"),3)]),t("div",zt,[t("div",Zt,[t("span",Ot,e(J(n[6])),1),t("span",Pt,e(H(n[3])),1)]),t("p",Kt,"Updated: "+e(A(n[4])),1)]),t("div",Rt,[t("div",qt,[s[7]||(s[7]=t("span",{class:"text-gray-500"},"Interval:",-1)),t("span",Ht,e(n[5])+"s",1)]),t("div",Jt,[s[8]||(s[8]=t("span",{class:"text-gray-500"},"Status:",-1)),t("span",Wt,e(n[7]===1?"Active":"Inactive"),1)])])]))),128))]))]),t("div",Yt,[s[10]||(s[10]=t("div",{class:"flex justify-between items-center mb-4"},[t("h2",{class:"text-2xl font-bold text-gray-900"},"Notification Settings")],-1)),N.value?(l(),i("div",Gt,s[9]||(s[9]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},null,-1)]))):b.value?(l(),i("div",Qt,e(b.value),1)):(l(),i("div",Xt,[(l(!0),i(F,null,M(V.value,n=>(l(),i("div",{key:n[0],onClick:ve=>Y(n[0]),class:"bg-gray-50 p-4 rounded-lg cursor-pointer hover:bg-gray-100 border border-gray-200"},[t("div",ee,[t("div",null,[t("h3",se,e(n[1]),1),t("p",oe,"ID: "+e(n[0]),1)]),t("span",{class:K(["px-2 py-1 text-xs rounded-full",n[4]?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},e(n[4]?"Enabled":"Disabled"),3)])],8,te))),128))]))]),f.value?(l(),i("div",{key:0,class:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center",onClick:T},[t("div",{class:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4",onClick:s[0]||(s[0]=nt(()=>{},["stop"]))},[t("h3",ae,e(f.value.name),1),t("div",ne,[t("div",null,[s[11]||(s[11]=t("h4",{class:"font-medium text-gray-900"},"Description",-1)),t("p",ie,e(f.value.description),1)]),t("div",null,[s[12]||(s[12]=t("h4",{class:"font-medium text-gray-900"},"Notification Settings",-1)),t("div",le,[t("div",null,[t("p",re,"Email: "+e(f.value.notifyViaEmail?"Enabled":"Disabled"),1),t("p",ce,"SMS: "+e(f.value.notifyViaSms?"Enabled":"Disabled"),1),t("p",de,"Phone: "+e(f.value.notifyViaPhone?"Enabled":"Disabled"),1)]),t("div",null,[t("p",ue,"Status: "+e(f.value.isEnabled?"Active":"Inactive"),1),t("p",fe,"Delay: "+e(f.value.delay)+" minutes",1),t("p",he,"No Spam: "+e(f.value.noSpam)+" minutes",1)])])])]),t("div",{class:"mt-6 flex justify-end"},[t("button",{onClick:T,class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500"}," Close ")])])])):O("",!0),t("div",ge,[t("p",ye,[P(" Version "+e(j(o))+" ("+e(j(r))+") ",1),s[13]||(s[13]=t("span",{class:"mx-1"},"·",-1)),s[14]||(s[14]=t("a",{href:"https://github.com/klaushofrichter/SwiftEventWeb/blob/develop/README.md",target:"_blank",rel:"noopener noreferrer",class:"text-indigo-600 hover:text-indigo-800"}," README ",-1))])])])}}};export{xe as default};
